{"ast":null,"code":"var _jsxFileName = \"/Users/MJ/web/project/1902A/redux-car-thunk/src/components/LazyLoad.js\";\nimport React, { Component } from 'react';\nimport { debounce, throttle } from '../utils/index';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class LazyLoad extends Component {\n  constructor(props) {\n    super(props);\n    this.wrap = /*#__PURE__*/React.createRef();\n    this.lazyLoad = debounce(this.lazyLoad.bind(this));\n  }\n\n  componentDidMount() {\n    this.wrap.current.addEventListener('scroll', e => {\n      this.lazyLoad();\n    }); // 检讨后代dom的变化\n\n    const ob = new MutationObserver(() => {\n      this.lazyLoad();\n    });\n    ob.observe(this.wrap.current, {\n      subtree: true,\n      childList: true\n    });\n  }\n\n  lazyLoad() {\n    let imgs = this.getImgsElement();\n    imgs.forEach(item => {\n      if (!this.isLoad(item) && this.isIntoView(item)) {\n        item.src = item.dataset.src;\n      }\n    });\n  }\n\n  getImgsElement() {\n    return [...this.wrap.current.querySelectorAll('img[data-src]')];\n  }\n\n  isLoad(el) {\n    return el.src === el.dataset.src;\n  }\n\n  isIntoView(el) {\n    let clients = el.getBoundingClientRect();\n    return !(clients.top > window.innerHeight || clients.bottom < 0 || clients.right > window.innerWidth || clients.left > window.innerWidth);\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: this.wrap,\n      style: {\n        height: '100%',\n        overflowY: 'scroll'\n      },\n      children: this.props.children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 13\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["/Users/MJ/web/project/1902A/redux-car-thunk/src/components/LazyLoad.js"],"names":["React","Component","debounce","throttle","LazyLoad","constructor","props","wrap","createRef","lazyLoad","bind","componentDidMount","current","addEventListener","e","ob","MutationObserver","observe","subtree","childList","imgs","getImgsElement","forEach","item","isLoad","isIntoView","src","dataset","querySelectorAll","el","clients","getBoundingClientRect","top","window","innerHeight","bottom","right","innerWidth","left","render","height","overflowY","children"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAAQC,QAAR,EAAkBC,QAAlB,QAAiC,gBAAjC;;AAEA,eAAe,MAAMC,QAAN,SAAuBH,SAAvB,CAAiC;AAC5CI,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACf,UAAMA,KAAN;AACA,SAAKC,IAAL,gBAAYP,KAAK,CAACQ,SAAN,EAAZ;AACA,SAAKC,QAAL,GAAgBP,QAAQ,CAAC,KAAKO,QAAL,CAAcC,IAAd,CAAmB,IAAnB,CAAD,CAAxB;AACH;;AAEDC,EAAAA,iBAAiB,GAAE;AACf,SAAKJ,IAAL,CAAUK,OAAV,CAAkBC,gBAAlB,CAAmC,QAAnC,EAA6CC,CAAC,IAAE;AAC7C,WAAKL,QAAL;AACF,KAFD,EADe,CAIf;;AACA,UAAMM,EAAE,GAAG,IAAIC,gBAAJ,CAAqB,MAAI;AAChC,WAAKP,QAAL;AACH,KAFU,CAAX;AAGAM,IAAAA,EAAE,CAACE,OAAH,CAAW,KAAKV,IAAL,CAAUK,OAArB,EAA8B;AAC1BM,MAAAA,OAAO,EAAE,IADiB;AAE1BC,MAAAA,SAAS,EAAE;AAFe,KAA9B;AAIH;;AAEDV,EAAAA,QAAQ,GAAE;AACN,QAAIW,IAAI,GAAG,KAAKC,cAAL,EAAX;AACAD,IAAAA,IAAI,CAACE,OAAL,CAAaC,IAAI,IAAE;AACf,UAAI,CAAC,KAAKC,MAAL,CAAYD,IAAZ,CAAD,IAAsB,KAAKE,UAAL,CAAgBF,IAAhB,CAA1B,EAAgD;AAC5CA,QAAAA,IAAI,CAACG,GAAL,GAAWH,IAAI,CAACI,OAAL,CAAaD,GAAxB;AACH;AACJ,KAJD;AAKH;;AAEDL,EAAAA,cAAc,GAAE;AACZ,WAAO,CAAC,GAAG,KAAKd,IAAL,CAAUK,OAAV,CAAkBgB,gBAAlB,CAAmC,eAAnC,CAAJ,CAAP;AACH;;AAEDJ,EAAAA,MAAM,CAACK,EAAD,EAAI;AACN,WAAOA,EAAE,CAACH,GAAH,KAAWG,EAAE,CAACF,OAAH,CAAWD,GAA7B;AACH;;AAEDD,EAAAA,UAAU,CAACI,EAAD,EAAI;AACV,QAAIC,OAAO,GAAGD,EAAE,CAACE,qBAAH,EAAd;AACA,WAAO,EAAGD,OAAO,CAACE,GAAR,GAAcC,MAAM,CAACC,WAAtB,IAAuCJ,OAAO,CAACK,MAAR,GAAiB,CAAxD,IACRL,OAAO,CAACM,KAAR,GAAgBH,MAAM,CAACI,UADf,IAC+BP,OAAO,CAACQ,IAAR,GAAeL,MAAM,CAACI,UADvD,CAAP;AAEH;;AAEDE,EAAAA,MAAM,GAAG;AACL,wBACI;AAAK,MAAA,GAAG,EAAE,KAAKhC,IAAf;AAAqB,MAAA,KAAK,EAAE;AAACiC,QAAAA,MAAM,EAAE,MAAT;AAAiBC,QAAAA,SAAS,EAAE;AAA5B,OAA5B;AAAA,gBACI,KAAKnC,KAAL,CAAWoC;AADf;AAAA;AAAA;AAAA;AAAA,YADJ;AAKH;;AAlD2C","sourcesContent":["import React, { Component } from 'react'\nimport {debounce, throttle} from '../utils/index'\n\nexport default class LazyLoad extends Component {\n    constructor(props) {\n        super(props);\n        this.wrap = React.createRef();\n        this.lazyLoad = debounce(this.lazyLoad.bind(this));\n    }\n\n    componentDidMount(){\n        this.wrap.current.addEventListener('scroll', e=>{\n           this.lazyLoad();\n        })\n        // 检讨后代dom的变化\n        const ob = new MutationObserver(()=>{\n            this.lazyLoad();\n        })\n        ob.observe(this.wrap.current, {\n            subtree: true,\n            childList: true\n        })\n    }\n\n    lazyLoad(){\n        let imgs = this.getImgsElement();\n        imgs.forEach(item=>{\n            if (!this.isLoad(item) && this.isIntoView(item)){\n                item.src = item.dataset.src;\n            }\n        })\n    }\n\n    getImgsElement(){\n        return [...this.wrap.current.querySelectorAll('img[data-src]')];\n    }\n\n    isLoad(el){\n        return el.src === el.dataset.src;\n    }\n\n    isIntoView(el){\n        let clients = el.getBoundingClientRect();\n        return !((clients.top > window.innerHeight) || (clients.bottom < 0) || \n        (clients.right > window.innerWidth) || (clients.left > window.innerWidth));\n    }\n\n    render() {\n        return (\n            <div ref={this.wrap} style={{height: '100%', overflowY: 'scroll'}}>{\n                this.props.children    \n            }</div>\n        )\n    }\n}\n"]},"metadata":{},"sourceType":"module"}